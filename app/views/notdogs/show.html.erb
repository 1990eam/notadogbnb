<div class="container show-container">
  <h1><%= @notdog.name %></h1>
  <div class="row show-row">
    <div class="col-lg-3 col-6">

      <!-- Card -->
          <div class="card-notdog mb-3">
            <img src=<%= cl_image_path @notdog.photo.key, height: 500, width: 700, crop: :fill %> >
            <div class="card-notdog-infos">
              <div>
                <p class="text-black-50"><%= @notdog.taxonomy_fantasy_name %> (<%= @notdog.taxonomy_name %>)</p>
                <h2><%= link_to @notdog.name, notdog_path(@notdog) %></h2>
                <p><%= @notdog.description %></p>
              </div>
                  <p class="card-notdog-pricing">USD$<%= @notdog.cost_per_day %></p>
            </div>

            <div class="book-button">
              <% if @notdog.owner != current_user %>
                <%= link_to "Book this Notdog", new_notdog_booking_path(@notdog), class: "btn btn-primary book-button" %>
              <% end %>
            </div>
          </div>
    </div>

      <!-- Details & Map -->
    <div class="infos">

      <div class="col-log-4 details">
        <h2>Other details:</h2>
        <p>Owner: <%= @notdog.owner.name %> </p>
        <p>Fantasy name: <%= @notdog.taxonomy_fantasy_name %></p>
        <p>Cost per day: <%= @notdog.cost_per_day %></p>
        <p>Location: <%= @notdog.address %></p>
      </div>

      <div class="card-category" id="map-card"
        style="width: 25vw; height: 25vh;"
        data-markers="<%= @markers.to_json %>"
        data-mapbox-api-key="<%= ENV["MAPBOX_API_KEY"] %>">
    </div>

      <!-- Update & Delete -->
      <div>
        <% if policy(@notdog).destroy? %>
          <%= link_to "Delete", notdog_path(@notdog), method: :delete, data: { confirm: 'Are you certain you want to delete this?' }  %>
        <% end %>

        <% if policy(@notdog).update? %>
          <%= link_to "Edit", edit_notdog_path(@notdog) %>
        <% end %>
      </div>

    </div>

  </div>
</div>


<!-- Messages Q&A -->
<div class="container show-container">
  <div class="row show-row">

    <div class="messages">
      <h2>Q&A</h2>
        <%= link_to "Unsure? Ask a question", new_notdog_message_path(@notdog) %>

        <% @messages.each do |message| %>

        <div class="interaction">

            <div class="message-body">
              <%= message.body %> <span class="created-at">(<%= message.created_at %>)</span>
              <% if policy(message).update? %>
                <%= link_to "Reply", edit_notdog_message_path(@notdog, message) %>
              <% end %>

              <% if policy(message).destroy? %>
                <%= link_to "Delete question", notdog_message_path(message), method: :delete, data: { confirm: 'Are you certain you want to delete this?' }  %>
              <% end %>
            </div>

            <div class="message-answer">
              <%= message.answer %> <span class="updated-at">(<%= message.updated_at %>)</span>
            </div>

        </div>
        <% end %>
    </div>
  </div>
</div>




